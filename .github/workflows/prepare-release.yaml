name: Prepare Production Release

on:
    workflow_dispatch:

jobs:
    build:
      name: Prepare
      runs-on: ubuntu-latest
      steps:
            - name: GIT Checkout
              uses: actions/checkout@v4
              
            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: 20

            - name: Install
              run: npm i

            - name: Deploy
              run: |
                mkdir -p dist
                date > dist/info.txt
                cat dist/info.txt
            
            - name: Release
              env:
                  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              run: |
                  VERSION='v0.0.1' curl -L -X POST -H "Accept: application/vnd.github+json" -H "Authorization: Bearer $GH_TOKEN" -H "X-GitHub-Api-Version: 2022-11-28" https://api.github.com/repos/ladislaves/fastify-rest-test/releases -d "{\"tag_name":\"$VERSION\",\"target_commitish\":\"master\",\"name\":\"$VERSION\",\"body\":\"Release of $VERSION\",\"draft\":false,\"prerelease\":false,\"generate_release_notes\":false}"

            
